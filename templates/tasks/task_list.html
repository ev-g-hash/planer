{% extends 'tasks/base.html' %}

{% block title %}–í—Å–µ –∑–∞–¥–∞—á–∏{% endblock %}

{% block content %}
<div class="container">
    <header class="header">
        <h1>üìã –í—Å–µ –∑–∞–¥–∞—á–∏ ({{ tasks.count }})</h1>
        <nav class="nav">
            <a href="{% url 'task_list' %}">üìã –í—Å–µ –∑–∞–¥–∞—á–∏</a>
            <a href="{% url 'task_create' %}">‚ûï –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞</a>
            <a href="{% url 'landing' %}">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
        </nav>
    </header>

    {% if tasks %}
        {% regroup tasks by status as status_list %}
        
        {% for status in status_list %}
        <div class="card">
            <h2>
                {% if status.grouper == 'new' %}üÜï –ù–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
                {% elif status.grouper == 'in_progress' %}‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ
                {% elif status.grouper == 'done' %}‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ
                {% elif status.grouper == 'overdue' %}‚ö†Ô∏è –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ
                {% endif %}
            </h2>
            
            {% for task in status.list %}
            <div class="task-item">
                <div class="task-content">
                    <div class="task-title">{{ task.title }}</div>
                    <div class="task-meta">
                        <span class="badge badge-{{ task.status }}">{{ task.get_status_display }}</span>
                        {% if task.due_date %}
                        <span class="task-date">üìÖ {{ task.due_date|date:"d.m.Y H:i" }}</span>
                        {% endif %}
                    </div>
                    {% if task.description %}
                    <p class="task-description">{{ task.description }}</p>
                    {% endif %}
                </div>
                <div class="task-actions">
                    <a href="{% url 'task_toggle' task.id %}" class="btn btn-sm" title="–°–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å">
                        {% if task.status == 'done' %}‚Ü©Ô∏è{% else %}‚úÖ{% endif %}
                    </a>
                    <a href="{% url 'task_update' task.id %}" class="btn btn-sm" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</a>
                    <a href="{% url 'task_delete' task.id %}" class="btn btn-danger btn-sm" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</a>
                </div>
            </div>
            {% endfor %}
        </div>
        {% endfor %}
    {% else %}
        <div class="card">
            <div class="empty-message">
                <div class="icon">üì≠</div>
                <p>–ó–∞–¥–∞—á –ø–æ–∫–∞ –Ω–µ—Ç</p>
                <a href="{% url 'task_create' %}" class="btn">‚ûï –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É</a>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}